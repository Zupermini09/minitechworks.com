<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3D Printing â€“ MiniTechWorks</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="dark.css">
  <link rel="icon" href="/favicon.ico" />
  <meta name="description" content="3D printing services at MiniTechWorks. Fair pricing per gram and fast replies." />
</head>

<body>
<header class="site-header">
  <div class="container header-inner">
    <a href="index.html" class="logo">
      <img src="favicon.png" class="logo-img" alt="Logo">
      <span class="logo-text">MiniTechWorks</span>
    </a>
    <nav class="nav">
      <a href="3d-print.html" class="active">3D Printing</a>
      <a href="pc-builds.html">PC Builds</a>
      <a href="wiki.html">Tutorials</a>
      <a href="contact.html">Contact</a>
    </nav>
  </div>
</header>

<main>
  <section class="section">
    <div class="container">

      <h1 class="section-title">3D Printing Service</h1>
      <p>
        Custom 3D prints priced fairly at <strong>0.40 NOK per gram</strong>.
        Upload your STL link from MakerWorld, Printables, Thingiverse, Google Drive, etc.
      </p>

      <!-- Cost Estimator -->
      <h2 class="section-title small">Estimated Cost</h2>

      <label><strong>Estimated weight (grams)</strong></label>
      <input id="gramsInput" type="number" class="input" value="60" min="1">

      <p id="estimateText" class="form-status">Estimated: 24.00 NOK</p>

      <hr class="divider">

      <!-- Request Form -->
      <h2 class="section-title">Request a 3D Print</h2>

      <form id="printForm" class="form">
        <label>Name</label>
        <input name="name" type="text" required>

        <label>Email</label>
        <input name="email" type="email" required>

        <label>3D Model Link (MakerWorld, Printables, Thingiverse, Google Drive, etc)</label>
        <input name="fileLink" type="text" inputmode="url" pattern="https?://.*"
               placeholder="https://makerworld.com/model/123..." required>

        <label>Material</label>
        <select name="material">
          <option>PLA</option>
          <option>PETG</option>
          <option>ABS / ASA</option>
          <option>TPU (flexible)</option>
          <option>Other</option>
        </select>

        <label>Color</label>
        <input name="color" type="text" placeholder="Black, White, Grey, Red, etc.">

        <label>Estimated Grams (optional)</label>
        <input name="grams" type="number" min="1">

        <label>Notes</label>
        <textarea name="notes" placeholder="Strength, infill, usage, tolerances, etc."></textarea>

        <button type="submit" class="btn btn-primary">Send Request</button>
      </form>

      <p id="printStatus" class="form-status"></p>
    </div>
  </section>
</main>

<footer class="site-footer">
  <div class="container footer-inner">
    <p>Â© <span id="year"></span> MiniTechWorks. Built by Mini.</p>
  </div>
</footer>

<script>
  const WEBHOOK_B64 =
    "aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTQzOTI2NTc4MDcwODU0MDQxNi9GNjNGTG5FNTQzcXFiVHk2Q01UbEQybUh5SjF2djFadzFOQXBpTjJlbXFNUTQwLVJYOEJhVndxWTQ2dVBacEFFcDRBbg==";

  const WEBHOOK_URL = atob(WEBHOOK_B64);

  // Price per gram
  const PRICE = 0.4;

  // Calculator
  const gramsInput = document.getElementById("gramsInput");
  const estText = document.getElementById("estimateText");

  function updateEstimate() {
    const g = Number(gramsInput.value) || 0;
    estText.textContent = "Estimated: " + (g * PRICE).toFixed(2) + " NOK";
  }

  gramsInput.addEventListener("input", updateEstimate);
  updateEstimate();

  // Discord submit
  document.getElementById("printForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const form = new FormData(e.target);
    const btn = e.target.querySelector("button");
    const status = document.getElementById("printStatus");

    btn.disabled = true;
    status.textContent = "Sending...";

    // Estimated price logic
    const grams = Number(form.get("grams") || 0);
    const estimatedPrice = grams > 0 ? (grams * PRICE).toFixed(2) + " NOK" : "N/A";

    const content =
      "ðŸ§± **New 3D Print Request â€“ MiniTechWorks**\n\n" +
      "**Name:** " + form.get("name") + "\n" +
      "**Email:** " + form.get("email") + "\n" +
      "**Model Link:** " + form.get("fileLink") + "\n" +
      "**Material:** " + form.get("material") + "\n" +
      "**Color:** " + (form.get("color") || "N/A") + "\n" +
      "**Estimated Weight:** " + (grams || "N/A") + " g\n" +
      "**Estimated Price:** " + estimatedPrice + "\n" +
      "**Notes:** " + (form.get("notes") || "N/A");

    try {
      await fetch(WEBHOOK_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ content })
      });

      status.textContent = "Request sent! Iâ€™ll get back to you soon.";
      status.classList.add("success");
      e.target.reset();
      updateEstimate();
    } catch {
      status.textContent = "Something went wrong!";
      status.classList.add("error");
    }

    btn.disabled = false;
  });
</script>

</body>
</html>
